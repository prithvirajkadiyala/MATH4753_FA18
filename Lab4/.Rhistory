#This will be a different path if in the lab or at home
dird="C:\\Users\\prith\\OneDrive\\Documents\\MATH4753_FA18\\DATAxls"
#my function to read data
myread=function(csv){
fl=paste(dird,csv,sep="")
read.table(fl,header=TRUE,sep=",")
}
spruce.df=myread("SPRUCE.csv")#MS pg478
spruce.df=myread("SPRUCE.csv")#MS pg478
#This will be a different path if in the lab or at home
dird="C:\\Users\\prith\\OneDrive\\Documents\\MATH4753_FA18\\DATAxls\\"
#my function to read data
myread=function(csv){
fl=paste(dird,csv,sep="")
read.table(fl,header=TRUE,sep=",")
}
spruce.df=myread("SPRUCE.csv")#MS pg478
with(spruce.df, dput(list(D=BHDiameter,H=Height),
file="spruce.dat"))
# Or use
spruce.df=read.table(file.choose(),header=TRUE,sep=",")
#get wd
getwd()
setwd("C:/Users/prith/OneDrive/Documents/MATH4753_FA18/Lab4")
#get wd
getwd()
#Top six lines
tail(spruce.df)
y.lm=lm(Height~BHDiameter, spruce.df)
y.lm
#load s20x library and make lowess smoother
library(s20x)
trendscatter(Height~BHDiameter,f=0.5,data=spruce.df)
# Now make the linear model
spruce.lm=lm(Height~BHDiameter,data=spruce.df)
summary(spruce.lm)
#residuals  created from the linear model object
height.res=residuals(spruce.lm)
#fitted values made from the linear model object
height.fit=fitted(y.lm)
#Make the plot using the plot function
plot(height.fit,height.res)
# Put a lowess smoother through res vs fitted
trendscatter( height.fit,height.res)
# Quick way to make a residual plot
plot(y.lm, which =1)
## Quadratic object using the linear model
quad.lm=lm(Height~BHDiameter + I(BHDiameter^2),data=spruce.df)
summary(quad.lm)
summary(quad.lm)
add1(spruce.lm,.~.+I(BHDiameter^2))
ciReg(quad.lm)
#This will be a different path if in the lab or at home
dird="C:\\Users\\prith\\OneDrive\\Documents\\MATH4753_FA18\\DATAxls\\"
#my function to read data
myread=function(csv){
fl=paste(dird,csv,sep="")
read.table(fl,header=TRUE,sep=",")
}
#This will be a different path if in the lab or at home
dird="C:\\Users\\prith\\OneDrive\\Documents\\MATH4753_FA18\\DATAxls\\"
#my function to read data
myread=function(csv){
fl=paste(dird,csv,sep="")
read.table(fl,header=TRUE,sep=",")
}
spruce.df=myread("SPRUCE.csv")#MS pg478
with(spruce.df, dput(list(D=BHDiameter,H=Height),
file="spruce.dat"))
# Or use
# spruce.df=read.table(file.choose(),header=TRUE,sep=",")
tail(spruce.df)
y.lm=lm(Height~BHDiameter, spruce.df)
y.lm
#get wd
getwd()
#Last six lines
tail(spruce.df)
#Plot the points
windows()
#load s20x library and make lowess smoother
library(s20x)
trendscatter(Height~BHDiameter,f=0.5,data=spruce.df)
# Now make the linear model
spruce.lm=lm(Height~BHDiameter,data=spruce.df)
summary(spruce.lm)
#residuals  created from the linear model object
height.res=residuals(spruce.lm)
#fitted values made from the linear model object
height.fit=fitted(spruce.lm)
#Make the plot using the plot function
plot(height.fit,height.res)
# Put a lowess smoother through res vs fitted
trendscatter( height.fit,height.res)
# Quick way to make a residual plot
plot(spruce.lm, which =1)
?normcheck
# Two plots testing normality
windows()
normcheck(spruce.lm,shapiro.wilk = TRUE)
cubic.lm=lm(Height~BHDiameter + I(BHDiameter^2)+I(BHDiameter^3),data=spruce.df[c(1,2,3),])
summary(cubic.lm)
#Make the plot using the plot function
plot(height.fit,height.res)
# Put a lowess smoother through res vs fitted
trendscatter( height.fit,height.res)
knitr::opts_chunk$set(echo = TRUE)
plot(spruce.lm, which =1)
normcheck(spruce.lm,shapiro.wilk = TRUE)
normcheck(spruce.lm,shapiro.wilk = TRUE)
quad.lm=lm(Height~BHDiameter + I(BHDiameter^2),data=spruce.df)
summary(quad.lm)
ciReg(quad.lm)
quad.lm=lm(Height~BHDiameter + I(BHDiameter^2),data=spruce.df)
summary(quad.lm)
add1(spruce.lm,.~.+I(BHDiameter^2))
anova(spruce.lm)
anova(quad.lm)
anova(spruce.lm,quad.lm)
cubic.lm=lm(Height~BHDiameter + I(BHDiameter^2)+I(BHDiameter^3),data=spruce.df)
summary(cubic.lm)
anova(cubic.lm)
add1(quad.lm,.~.+I(BHDiameter^3))
#add to the scatter plot
windows()
plot(Height~BHDiameter,bg="Blue",pch=21,cex=1.2,
ylim=c(0,max(Height)),xlim=c(0,max(BHDiameter)),
main="Spruce height prediction",data=spruce.df)
coef(quad.lm)
names(quad.lm)
quad.lm$coef[2]
myplot=function(x){
0.86089580 +1.46959217*x  -0.02745726*x^2
}
#Or more general method
myplot=function(x){
quad.lm$coef[1] +quad.lm$coef[2]*x  + quad.lm$coef[3]*x^2
}
curve(myplot, lwd=2, col="steelblue",add=TRUE)
add1(spruce.lm,.~.+I(BHDiameter^2))
anova(spruce.lm)
anova(quad.lm)
anova(spruce.lm,quad.lm)
cubic.lm=lm(Height~BHDiameter + I(BHDiameter^2)+I(BHDiameter^3),data=spruce.df)
summary(cubic.lm)
anova(cubic.lm)
add1(quad.lm,.~.+I(BHDiameter^3))
#add to the scatter plot
windows()
plot(Height~BHDiameter,bg="Blue",pch=21,cex=1.2,
ylim=c(0,max(Height)),xlim=c(0,max(BHDiameter)),
main="Spruce height prediction",data=spruce.df)
coef(quad.lm)
names(quad.lm)
quad.lm$coef[2]
myplot=function(x){
0.86089580 +1.46959217*x  -0.02745726*x^2
}
#Or more general method
myplot=function(x){
quad.lm$coef[1] +quad.lm$coef[2]*x  + quad.lm$coef[3]*x^2
}
curve(myplot, lwd=2, col="steelblue",add=TRUE)
add1(spruce.lm,.~.+I(BHDiameter^2))
anova(spruce.lm)
anova(quad.lm)
anova(spruce.lm,quad.lm)
cubic.lm=lm(Height~BHDiameter + I(BHDiameter^2)+I(BHDiameter^3),data=spruce.df)
summary(cubic.lm)
anova(cubic.lm)
add1(quad.lm,.~.+I(BHDiameter^3))
#add to the scatter plot
plot(Height~BHDiameter,bg="Blue",pch=21,cex=1.2,
ylim=c(0,max(Height)),xlim=c(0,max(BHDiameter)),
main="Spruce height prediction",data=spruce.df)
coef(quad.lm)
names(quad.lm)
quad.lm$coef[2]
myplot=function(x){
0.86089580 +1.46959217*x  -0.02745726*x^2
}
#Or more general method
myplot=function(x){
quad.lm$coef[1] +quad.lm$coef[2]*x  + quad.lm$coef[3]*x^2
}
curve(myplot, lwd=2, col="steelblue",add=TRUE)
add1(quad.lm,.~.+I(BHDiameter^3))
#add to the scatter plot
plot(Height~BHDiameter,bg="Blue",pch=21,cex=1.2,
ylim=c(0,max(Height)),xlim=c(0,max(BHDiameter)),
main="Spruce height prediction",data=spruce.df)
coef(quad.lm)
names(quad.lm)
quad.lm$coef[2]
myplot=function(x){
0.86089580 +1.46959217*x  -0.02745726*x^2
}
#Or more general method
myplot=function(x){
quad.lm$coef[1] +quad.lm$coef[2]*x  + quad.lm$coef[3]*x^2
}
curve(myplot, lwd=2, col="steelblue",add=TRUE)
add1(quad.lm,.~.+I(BHDiameter^3))
#add to the scatter plot
plot(Height~BHDiameter,bg="Blue",pch=21,cex=1.2,
ylim=c(0,max(Height)),xlim=c(0,max(BHDiameter)),
main="Spruce height prediction",data=spruce.df)
myplot=function(x){
0.86089580 +1.46959217*x  -0.02745726*x^2
}
#Or more general method
myplot=function(x){
quad.lm$coef[1] +quad.lm$coef[2]*x  + quad.lm$coef[3]*x^2
}
curve(myplot, lwd=2, col="green3",add=TRUE)
#add1(quad.lm,.~.+I(BHDiameter^3))
#add to the scatter plot
plot(Height~BHDiameter,bg="Blue",pch=21,cex=1.2,
ylim=c(0,max(Height)),xlim=c(0,max(BHDiameter)),
main="Spruce height prediction",data=spruce.df)
myplot=function(x){
0.86089580 +1.46959217*x  -0.02745726*x^2
}
#Or more general method
myplot=function(x){
quad.lm$coef[1] +quad.lm$coef[2]*x  + quad.lm$coef[3]*x^2
}
curve(myplot, lwd=2, col="green3",add=TRUE)
