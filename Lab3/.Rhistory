barplot(xhist$counts, axes=FALSE, ylim=c(0, top), space=0)
par(mar=c(3,0,1,1))
barplot(yhist$counts, axes=FALSE, xlim=c(0, top), space=0, horiz=TRUE)
par(oma=c(3,3,0,0))
mtext(xlab, side=1, line=1, outer=TRUE, adj=0,
at=.8 * (mean(x) - min(x))/(max(x)-min(x)))
mtext(ylab, side=2, line=1, outer=TRUE, adj=0,
at=(.8 * (mean(y) - min(y))/(max(y) - min(y))))
}
with(ddt, scatterhist(LENGTH,WEIGHT, xlab="LENGTH"))
#Make a histogram
with(ddt, hist(DDT))
source('C:/Users/prith/Desktop/ECE/Applied Statistical Methods/lab1.R')
source('C:/Users/prith/Desktop/ECE/Applied Statistical Methods/lab1.R')
getwd()
spruce.df=read.table(file.choose(),header=TRUE,sep=",")
library(s20x)
windows()
pairs20x(spruce.df)
getwd()
spruce.df=read.table(file.choose(),header=TRUE,sep=",")
library(s20x)
getwd()
spruce.df=read.table(file.choose(),header=TRUE,sep=",")
getwd()
spruce.df=read.table(file.choose(),header=TRUE,sep=",")
getwd()
spruce.df=read.table(file.choose(),header=TRUE,sep=",")
choose(10,8)
gamma(2)
gamma(4)
knitr::opts_chunk$set(echo = TRUE)
plot(ddt$LENGTH,ddt$WEIGHT)
ddt=read.csv("DDT.csv")
head(ddt)
plot(ddt$LENGTH,ddt$WEIGHT)
plot(ddt$LENGTH,ddt$WEIGHT,xlab="LENGTH",ylab="WEIGHT")
plot(ddt$WEIGHT,ddt$LENGTH,xlab="WEIGHT",ylab="LENGTH")
knitr::opts_chunk$set(echo = TRUE)
getwd()
DDT = read.csv("DDT.csv", header=TRUE, sep=",")
head(DDT)
m=with(DDT, as.numeric(levels(factor(MILE))))
colm = c()
for (i in 1:length(DDT$MILE)) {
colm[i]=which(DDT$MILE[i]==m)
}
coplot(LENGTH~WEIGHT|RIVER*SPECIES,data=DDT,col=colm)
v = 3,4,5,6,7,8
v = c(3,4,5,6)
sd(v)
v * 3
sd(v)
v * -1
u = v*-3
sd(u)
v = c(3,4,5,6)
u = v*0.5
sd(u)
sd(v)
v = c(5,4,5,6)
sd(v)
v = c(3,4,5,6)
sd(v)
u = c(4,5,5,6)
sd(u)
u = c(4,5,6,8)
sd(u)
knitr::opts_chunk$set(echo = TRUE)
boxplot(ddt$DDT,col="Blue",data=ddt)
rivcol=with(ddt, ifelse(RIVER=="FCM","Red",
ifelse(RIVER=="LCM","Blue",
ifelse(RIVER=="SCM","Green","Black"))))
coplot(DDT~WEIGHT|SPECIES,data=ddt,col=rivcol)
rivcol=with(ddt, ifelse(RIVER=="FCM","Red",
ifelse(RIVER=="LCM","Blue",
ifelse(RIVER=="SCM","Green","Orange"))))
coplot(WEIGHT~LENGTH|RIVER,data=ddt,col=rivcol)
rivcol=with(ddt, ifelse(RIVER=="FCM","Red",
ifelse(RIVER=="LCM","Black",
ifelse(RIVER=="SCM","Green","Orange"))))
coplot(WEIGHT~LENGTH|RIVER,data=ddt,col=rivcol)
rivcol=with(ddt, ifelse(RIVER=="FCM","Blue",
ifelse(RIVER=="LCM","Black",
ifelse(RIVER=="SCM","Green","Orange"))))
coplot(WEIGHT~LENGTH|RIVER,data=ddt,col=rivcol)
rivcol=with(ddt, ifelse(RIVER=="FCM","Blue",
ifelse(RIVER=="LCM","Black",
ifelse(RIVER=="SCM","Green","Orange"))))
coplot(LENGTH~WEIGHT|RIVER,data=ddt,col=rivcol)
rivcol=with(ddt, ifelse(RIVER=="FCM","Red",
ifelse(RIVER=="LCM","Blue",
ifelse(RIVER=="SCM","Green","Black"))))
coplot(WEIGHT~DDT|SPECIES,data=ddt,col=rivcol)
rivcol=with(ddt, ifelse(RIVER=="FCM","Red",
ifelse(RIVER=="LCM","Blue",
ifelse(RIVER=="SCM","Green","Yellow"))))
coplot(WEIGHT~DDT|SPECIES,data=ddt,col=rivcol)
rivcol=with(ddt, ifelse(RIVER=="FCM","Red",
ifelse(RIVER=="LCM","Blue",
ifelse(RIVER=="SCM","Green","Orange"))))
coplot(WEIGHT~DDT|SPECIES,data=ddt,col=rivcol)
rivcol=with(ddt, ifelse(RIVER=="FCM","Red",
ifelse(RIVER=="LCM","Blue",
ifelse(RIVER=="SCM","Green","Orange"))))
coplot(DDT~WEIGHT|SPECIES,data=ddt,col=rivcol)
boxplot(WEIGHT,col="Red",data=ddt)
boxplot(ddt$WEIGHT,col="Red",data=ddt)
boxplot(ddt$LENGTH,col="Red",data=ddt)
boxplot(ddt$DDT,col="Orange",data=ddt)
install.packages("readxl")
install.packages("s20x")
setwd("C:/Users/prith/OneDrive/Documents/MATH4753 FA18/Lab3")
mtbe = read.csv("MTBE.csv")
mtbe
table(mtbe$Aquifier,mtbe$MTBE.Detect)
table(mtbe$Aquifier,mtbe$MTBE.Detect)->tab4
addmargins(tab4)
round(7/223,4)
round((15+7+63)/223,4)
round(138/153,4)
round(7/70,4)
round(7/22,4)
round(7/22,4)
mtbe = read.csv("MTBE.csv")
mtbe
table(mtbe$Aquifier,mtbe$MTBE.Detect)->tab4
addmargins(tab4) #Adds up and gives the total columns
tab4
round(7/223,4)
addmargins(tab4) #Adds up and gives the total columns
install.packages(c("later", "stringi", "tinytex", "xtable"))
install.packages("stringi")
install.packages("stringi")
round(63/70,4)
round(15/223,4)
round((63+7+138)/22,4)
round((63+7+138)/223,4)
factorial(8)/factorial(6)*factorial(2)
factorial(8)/(factorial(6)*factorial(2))
setwd("C:/Users/prith/OneDrive/Documents/MATH4753_FA18/Lab3")
knitr::opts_chunk$set(echo = TRUE)
getwd()
spruce.df=myread("SPRUCE.csv")
spruce.df=read.csv("SPRUCE.csv")
spruce.df=read.csv("SPRUCE.csv")
head(spruce.df)
plot(Height~BHDiameter,bg="Blue",pch=21,cex=1.2,
ylim=c(0,max(Height)),xlim=c(0,max(BHDiameter)),
main="Spruce height prediction",data=spruce.df)
layout(matrix(1:3,nr=3,nc=1))
layout.show(3)
trendscatter(Height~BHDiameter,f=0.5,data=spruce.df)
install.packages("ggplot2")
layout(matrix(1:3,nr=3,nc=1))
layout.show(3)
trendscatter(Height~BHDiameter,f=0.5,data=spruce.df)
library(s20x)
layout(matrix(1:3,nr=3,nc=1))
layout.show(3)
trendscatter(Height~BHDiameter,f=0.5,data=spruce.df)
trendscatter(Height~BHDiameter,f=0.6,data=spruce.df)
trendscatter(Height~BHDiameter,f=0.7,data=spruce.df)
library(s20x)
layout(matrix(1:3,nr=3,nc=1))
layout.show(3)
trendscatter(Height~BHDiameter,f=0.5,data=spruce.df, main="f=0.5")
trendscatter(Height~BHDiameter,f=0.6,data=spruce.df)
trendscatter(Height~BHDiameter,f=0.7,data=spruce.df)
library(s20x)
layout(matrix(1:3,nr=3,nc=1))
layout.show(3)
trendscatter(Height~BHDiameter,f=0.5,data=spruce.df, main="Plot of Height vs BHDiameter with f=0.5")
trendscatter(Height~BHDiameter,f=0.6,data=spruce.df, main="Plot of Height vs BHDiameter with f=0.6")
trendscatter(Height~BHDiameter,f=0.7,data=spruce.df, main="Plot of Height vs BHDiameter with f=0.7")
# Now make the linear model
spruce.lm=lm(Height~BHDiameter,data=spruce.df)
plot(Height~BHDiameter,bg="Blue",pch=21,cex=1.2,
ylim=c(0,max(Height)),xlim=c(0,max(BHDiameter)),
main="Spruce height prediction",data=spruce.df)
abline(spruce.lm)
# Now make the linear model
spruce.lm=lm(Height~BHDiameter,data=spruce.df)
plot(Height~BHDiameter,bg="Blue",pch=21,cex=1.2,
ylim=c(0,max(Height)),xlim=c(0,max(BHDiameter)),
main="Spruce height prediction",data=spruce.df)
fitted(spruce.lm)
# Now make the linear model
spruce.lm=lm(Height~BHDiameter,data=spruce.df)
plot(Height~BHDiameter,bg="Blue",pch=21,cex=1.2,
ylim=c(0,max(Height)),xlim=c(0,max(BHDiameter)),
main="Spruce height prediction",data=spruce.df)
fitted(spruce.lm)
plot(spruce.lm,fitted(spruce.lm),type="1")
# Now make the linear model
spruce.lm=lm(Height~BHDiameter,data=spruce.df)
plot(Height~BHDiameter,bg="Blue",pch=21,cex=1.2,
ylim=c(0,max(Height)),xlim=c(0,max(BHDiameter)),
main="Spruce height prediction",data=spruce.df)
plot(spruce.lm)
lines(predict(spruce.lm))
# Now make the linear model
spruce.lm=lm(Height~BHDiameter,data=spruce.df)
plot(Height~BHDiameter,bg="Blue",pch=21,cex=1.2,
ylim=c(0,max(Height)),xlim=c(0,max(BHDiameter)),
main="Spruce height prediction",data=spruce.df)
plot(spruce.lm)
lines(predict(spruce.df))
# Now make the linear model
spruce.lm=lm(Height~BHDiameter,data=spruce.df)
plot(Height~BHDiameter,bg="Blue",pch=21,cex=1.2,
ylim=c(0,max(Height)),xlim=c(0,max(BHDiameter)),
main="Spruce height prediction",data=spruce.df)
abline(spruce.lm)
# Now make the linear model
spruce.lm=lm(Height~BHDiameter,data=spruce.df)
plot(Height~BHDiameter,bg="Blue",pch=21,cex=1.2,
ylim=c(0,max(Height)),xlim=c(0,max(BHDiameter)),
main="Spruce height prediction",data=spruce.df)
abline(spruce.lm)
plot(spruce.lm)
# Now make the linear model
spruce.lm=lm(Height~BHDiameter,data=spruce.df)
plot(Height~BHDiameter,bg="Blue",pch=21,cex=1.2,
ylim=c(0,max(Height)),xlim=c(0,max(BHDiameter)),
main="Spruce height prediction",data=spruce.df)
abline(spruce.lm)
plot(spruce.df)
# Now make the linear model
spruce.lm=lm(Height~BHDiameter,data=spruce.df)
plot(Height~BHDiameter,bg="Blue",pch=21,cex=1.2,
ylim=c(0,max(Height)),xlim=c(0,max(BHDiameter)),
main="Spruce height prediction",data=spruce.df)
abline(spruce.lm)
plot(spruce.df)
lines(predict(spruce.lm))
# Now make the linear model
spruce.lm=lm(Height~BHDiameter,data=spruce.df)
plot(Height~BHDiameter,bg="Blue",pch=21,cex=1.2,
ylim=c(0,max(Height)),xlim=c(0,max(BHDiameter)),
main="Spruce height prediction",data=spruce.df)
abline(spruce.lm)
plot(spruce.df, fitted(spruce.lm),type="1")
# Now make the linear model
spruce.lm=lm(Height~BHDiameter,data=spruce.df)
plot(Height~BHDiameter,bg="Blue",pch=21,cex=1.2,
ylim=c(0,max(Height)),xlim=c(0,max(BHDiameter)),
main="Spruce height prediction",data=spruce.df)
abline(spruce.lm)
plot(spruce.df, fitted(spruce.lm))
#Task 1
getwd()
#Task 2
spruce.df=read.csv("SPRUCE.csv")
head(spruce.df)
#Task 3
plot(Height~BHDiameter,bg="Blue",pch=21,cex=1.2,
ylim=c(0,max(Height)),xlim=c(0,max(BHDiameter)),
main="Spruce height prediction",data=spruce.df)
library(s20x)
layout(matrix(1:3,nr=3,nc=1))
layout.show(3)
trendscatter(Height~BHDiameter,f=0.5,data=spruce.df, main="Plot of Height vs BHDiameter with f=0.5")
trendscatter(Height~BHDiameter,f=0.6,data=spruce.df, main="Plot of Height vs BHDiameter with f=0.6")
trendscatter(Height~BHDiameter,f=0.7,data=spruce.df, main="Plot of Height vs BHDiameter with f=0.7")
# Now make the linear model
spruce.lm=lm(Height~BHDiameter,data=spruce.df)
plot(Height~BHDiameter,bg="Blue",pch=21,cex=1.2,
ylim=c(0,max(Height)),xlim=c(0,max(BHDiameter)),
main="Spruce height prediction",data=spruce.df)
abline(spruce.lm)
plot(spruce.df, fitted(spruce.lm))
layout(1)
plot(Height~BHDiameter,bg="Blue",pch=21,cex=1.2,
ylim=c(0,max(Height)),xlim=c(0,max(BHDiameter)),
main="Spruce height prediction",data=spruce.df)
abline(spruce.lm)
plot(spruce.df, fitted(spruce.lm))
lines(lowess(spruce.df))
# Now make the linear model
spruce.lm=lm(Height~BHDiameter,data=spruce.df)
layout(1)
plot(Height~BHDiameter,bg="Blue",pch=21,cex=1.2,
ylim=c(0,max(Height)),xlim=c(0,max(BHDiameter)),
main="Spruce height prediction",data=spruce.df)
abline(spruce.lm)
lines(lowess(spruce.df))
lines(lowess(spruce.df), col="blue")
# Now make the linear model
spruce.lm=lm(Height~BHDiameter,data=spruce.df)
layout(1)
plot(Height~BHDiameter,bg="Blue",pch=21,cex=1.2,
ylim=c(0,max(Height)),xlim=c(0,max(BHDiameter)),
main="Spruce height prediction",data=spruce.df)
abline(spruce.lm)
lines(lowess(spruce.df), col="blue")
# Now make the linear model
spruce.lm=lm(Height~BHDiameter,data=spruce.df)
layout(1)
plot(Height~BHDiameter,bg="Blue",pch=21,cex=1.2,
ylim=c(0,max(Height)),xlim=c(0,max(BHDiameter)),
main="Spruce height prediction",data=spruce.df)
abline(spruce.lm)
lines(lowess(spruce.df), col="blue")
# Now make the linear model
spruce.lm=lm(Height~BHDiameter,data=spruce.df)
layout(matrix=1:2,nr=1,nc=2)
# Now make the linear model
spruce.lm=lm(Height~BHDiameter,data=spruce.df)
layout(matrix(1:2,nr=1,nc=2))
plot(Height~BHDiameter,bg="Blue",pch=21,cex=1.2,
ylim=c(0,max(Height)),xlim=c(0,max(BHDiameter)),
main="Spruce height prediction",data=spruce.df)
abline(spruce.lm)
plot(Height~BHDiameter,bg="Blue",pch=21,cex=1.2,
ylim=c(0,max(Height)),xlim=c(0,max(BHDiameter)),
main="Spruce height prediction",data=spruce.df)
lines(lowess(spruce.df), col="blue")
# Now make the linear model
spruce.lm=lm(Height~BHDiameter,data=spruce.df)
layout(matrix(1:2,nr=2,nc=1))
plot(Height~BHDiameter,bg="Blue",pch=21,cex=1.2,
ylim=c(0,max(Height)),xlim=c(0,max(BHDiameter)),
main="Spruce height prediction",data=spruce.df)
abline(spruce.lm)
plot(Height~BHDiameter,bg="Blue",pch=21,cex=1.2,
ylim=c(0,max(Height)),xlim=c(0,max(BHDiameter)),
main="Spruce height prediction",data=spruce.df)
lines(lowess(spruce.df), col="blue")
# Now make the linear model
spruce.lm=lm(Height~BHDiameter,data=spruce.df)
layout(matrix(1:2,nr=1,nc=2))
plot(Height~BHDiameter,bg="Blue",pch=21,cex=1.2,
ylim=c(0,max(Height)),xlim=c(0,max(BHDiameter)),
main="Spruce height prediction",data=spruce.df)
abline(spruce.lm)
plot(Height~BHDiameter,bg="Blue",pch=21,cex=1.2,
ylim=c(0,max(Height)),xlim=c(0,max(BHDiameter)),
main="Spruce height prediction",data=spruce.df)
lines(lowess(spruce.df), col="blue")
# Now make the linear model
spruce.lm=lm(Height~BHDiameter,data=spruce.df)
plot(Height~BHDiameter,bg="Blue",pch=21,cex=1.2,
ylim=c(0,max(Height)),xlim=c(0,max(BHDiameter)),
main="Spruce height prediction",data=spruce.df)
abline(spruce.lm)
plot(Height~BHDiameter,bg="Blue",pch=21,cex=1.2,
ylim=c(0,max(Height)),xlim=c(0,max(BHDiameter)),
main="Spruce height prediction",data=spruce.df)
lines(lowess(spruce.df), col="blue")
layout(matrix(1:4,nr=2,nc=2,byrow=TRUE))
#Lets look at where the plots will go
layout.show(4)
#Plot the data
plot(Height~BHDiameter,bg="Blue",pch=21,cex=1.2,
ylim=c(0,1.1*max(Height)),xlim=c(0,1.1*max(BHDiameter)),
main="Spruce height prediction",data=spruce.df)
# add the line
abline(spruce.lm)
#make a new plot
plot(Height~BHDiameter,bg="Blue",pch=21,cex=1.2,
ylim=c(0,1.1*max(Height)),xlim=c(0,1.1*max(BHDiameter)),
main="Spruce height prediction",data=spruce.df)
abline(spruce.lm)
#make yhat the estimates of E[Height | BHDiameter]
yhat=with(spruce.df,predict(spruce.lm,data.frame(BHDiameter)))
yhat=fitted(spruce.lm)
# Draw in segments making the residuals (regression errors)
with(spruce.df,{
segments(BHDiameter,Height,BHDiameter,yhat)
})
RSS=with(spruce.df,sum((Height-yhat)^2))
RSS
#make a new plot
plot(Height~BHDiameter,bg="Blue",pch=21,cex=1.2,
ylim=c(0,1.1*max(Height)),xlim=c(0,1.1*max(BHDiameter)),
main="Spruce height prediction",data=spruce.df)
#make nieve model
with(spruce.df, abline(h=mean(Height)))
abline(spruce.lm)
#make the explained errors (explained by the model)
with(spruce.df, segments(BHDiameter,mean(Height),BHDiameter,yhat,col="Red"))
MSS=with(spruce.df,sum((yhat-mean(Height))^2))
MSS
# Total  error
#make a new plot
plot(Height~BHDiameter,bg="Blue",pch=21,cex=1.2,
ylim=c(0,1.1*max(Height)),xlim=c(0,1.1*max(BHDiameter)),
main="Spruce height prediction",data=spruce.df)
#This will be a different path if in the lab or at home
dird="\\Users\\HyDRO-Lab\\Desktop\\MATH4753\\DATAxls\\"
#my function to read data
myread=function(csv){
fl=paste(dird,csv,sep="")
read.table(fl,header=TRUE,sep=",")
}
#EASY WAY TO READ IN FILES
fin.df=myread("FINTUBES.csv")
with(spruce.df,abline(h=mean(Height)))
with(spruce.df, segments(BHDiameter,Height,BHDiameter,mean(Height),col="Green"))
layout(matrix(1:4,nr=2,nc=2,byrow=TRUE))
#plot1
plot(Height~BHDiameter,bg="Blue",pch=21,cex=1.2,
ylim=c(0,1.1*max(Height)),xlim=c(0,1.1*max(BHDiameter)),
main="Spruce height prediction",data=spruce.df)
abline(spruce.lm)
layout(matrix(1:4,nr=2,nc=2,byrow=TRUE))
#plot1
plot(Height~BHDiameter,bg="Blue",pch=21,cex=1.2,
ylim=c(0,1.1*max(Height)),xlim=c(0,1.1*max(BHDiameter)),
main="Spruce height prediction",data=spruce.df)
abline(spruce.lm)
layout(matrix(1:4,nr=2,nc=2,byrow=TRUE))
#plot1
plot(Height~BHDiameter,bg="Blue",pch=21,cex=1.2,
ylim=c(0,1.1*max(Height)),xlim=c(0,1.1*max(BHDiameter)),
main="Spruce height prediction",data=spruce.df)
abline(spruce.lm)
#plot2
plot(Height~BHDiameter,bg="Blue",pch=21,cex=1.2,
ylim=c(0,1.1*max(Height)),xlim=c(0,1.1*max(BHDiameter)),
main="Spruce height prediction",data=spruce.df)
abline(spruce.lm)
layout(matrix(1:4,nr=2,nc=2,byrow=TRUE))
#plot1
plot(Height~BHDiameter,bg="Blue",pch=21,cex=1.2,
ylim=c(0,1.1*max(Height)),xlim=c(0,1.1*max(BHDiameter)),
main="Spruce height prediction",data=spruce.df)
abline(spruce.lm)
#plot2
plot(Height~BHDiameter,bg="Blue",pch=21,cex=1.2,
ylim=c(0,1.1*max(Height)),xlim=c(0,1.1*max(BHDiameter)),
main="Spruce height prediction",data=spruce.df)
abline(spruce.lm)
yhat=with(spruce.df,predict(spruce.lm,data.frame(BHDiameter)))
yhat=fitted(spruce.lm)
# Draw in segments making the residuals (regression errors)
with(spruce.df,{
segments(BHDiameter,Height,BHDiameter,yhat)
})
layout(matrix(1:4,nr=2,nc=2,byrow=TRUE))
#plot1
plot(Height~BHDiameter,bg="Blue",pch=21,cex=1.2,
ylim=c(0,1.1*max(Height)),xlim=c(0,1.1*max(BHDiameter)),
main="Spruce height prediction",data=spruce.df)
abline(spruce.lm)
#plot2
plot(Height~BHDiameter,bg="Blue",pch=21,cex=1.2,
ylim=c(0,1.1*max(Height)),xlim=c(0,1.1*max(BHDiameter)),
main="Spruce height prediction",data=spruce.df)
abline(spruce.lm)
yhat=with(spruce.df,predict(spruce.lm,data.frame(BHDiameter)))
yhat=fitted(spruce.lm)
with(spruce.df,{
segments(BHDiameter,Height,BHDiameter,yhat)
})
#plot3
plot(Height~BHDiameter,bg="Blue",pch=21,cex=1.2,
ylim=c(0,1.1*max(Height)),xlim=c(0,1.1*max(BHDiameter)),
main="Spruce height prediction",data=spruce.df)
with(spruce.df, abline(h=mean(Height)))
abline(spruce.lm)
with(spruce.df, segments(BHDiameter,mean(Height),BHDiameter,yhat,col="Red"))
MSS/TSS
RSS=with(spruce.df,sum((Height-yhat)^2))
RSS
MSS=with(spruce.df,sum((yhat-mean(Height))^2))
MSS
TSS=with(spruce.df,sum((Height-mean(Height))^2))
TSS
MSS/TSS
TSS
MSS+RSS
summary(spruce.lm)
coef(spruce.lm)
coef(spruce.lm)
predict(spruce.lm, data.frame(BHDiameter=c(15,18,20)))
layout(matrix(1:4,nr=2,nc=2,byrow=TRUE))
#plot1
plot(Height~BHDiameter,bg="Blue",pch=21,cex=1.2,
ylim=c(0,1.1*max(Height)),xlim=c(0,1.1*max(BHDiameter)),
main="Spruce height prediction",data=spruce.df)
abline(spruce.lm)
#plot2
plot(Height~BHDiameter,bg="Blue",pch=21,cex=1.2,
ylim=c(0,1.1*max(Height)),xlim=c(0,1.1*max(BHDiameter)),
main="Spruce height prediction",data=spruce.df)
abline(spruce.lm)
yhat=with(spruce.df,predict(spruce.lm,data.frame(BHDiameter)))
yhat=fitted(spruce.lm)
with(spruce.df,{
segments(BHDiameter,Height,BHDiameter,yhat)
})
#plot3
plot(Height~BHDiameter,bg="Blue",pch=21,cex=1.2,
ylim=c(0,1.1*max(Height)),xlim=c(0,1.1*max(BHDiameter)),
main="Spruce height prediction",data=spruce.df)
with(spruce.df, abline(h=mean(Height)))
abline(spruce.lm)
with(spruce.df, segments(BHDiameter,mean(Height),BHDiameter,yhat,col="Red"))
#plot4
plot(Height~BHDiameter,bg="Blue",pch=21,cex=1.2,
ylim=c(0,1.1*max(Height)),xlim=c(0,1.1*max(BHDiameter)),
main="Spruce height prediction",data=spruce.df)
with(spruce.df,abline(h=mean(Height)))
with(spruce.df, segments(BHDiameter,Height,BHDiameter,mean(Height),col="Green"))
library(ggplot2)
ggplot(data = spruce.lm, aes(x = Height, y = BHDiameter)) +
geom_point(color='blue') +
geom_smooth(method = "lm", se = TRUE) +
geom_line(aes(Height, BHDiameter)) +
labs(title="Height Vs BHDiameter")
